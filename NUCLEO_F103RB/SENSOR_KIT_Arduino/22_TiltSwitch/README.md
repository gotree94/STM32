# 각도 스위치 모듈 (KY-020 Tilt Switch Module)

NUCLEO-F103RB 보드를 이용한 각도 스위치 모듈 테스트 프로젝트입니다.

## 📋 개요

각도 스위치(틸트 스위치)는 기울기를 감지하는 간단한 센서입니다. 내부에 금속 볼이나 원통이 있어 일정 각도 이상 기울어지면 접점이 연결되거나 끊어집니다. 수은을 사용하지 않아 친환경적이며 안전합니다.

## 🔧 하드웨어 구성

### 필요 부품
| 부품 | 수량 |
|------|------|
| NUCLEO-F103RB | 1 |
| 각도 스위치 모듈 (KY-020) | 1 |
| 점퍼 와이어 | 3 |

### 핀 연결

| 모듈 핀 | NUCLEO 핀 | 설명 |
|---------|-----------|------|
| VCC | 3.3V / 5V | 전원 |
| GND | GND | 접지 |
| Signal | PA0 | 디지털 출력 |

### 회로도

```
NUCLEO-F103RB            각도 스위치 모듈
    ┌─────┐               ┌─────────┐
    │ 3.3V├───────────────┤VCC      │
    │     │               │   ◯    │
    │  GND├───────────────┤GND  ●   │ ← 금속 볼
    │     │               │   ╲ ╱   │
    │  PA0├───────────────┤Signal   │
    └─────┘               └─────────┘
```

## 💻 소프트웨어 설정

### Arduino IDE 설정
1. **보드 매니저**: STM32 MCU based boards 설치
2. **보드 선택**: Nucleo-64 → Nucleo F103RB
3. **시리얼 포트**: 해당 COM 포트 선택

### 라이브러리
- 기본 라이브러리만 사용 (추가 설치 불필요)

## 📝 기능 설명

### 기본 기능
- 기울기 감지 및 LED 표시
- 기울임 횟수 카운트
- 기울어진 시간 측정
- 안정성 상태 감지

### 시리얼 명령

| 명령 | 기능 |
|------|------|
| s | 상태 및 통계 출력 |
| r | 통계 리셋 |
| a | 경보 모드 ON/OFF 토글 |

## 🖥️ 시리얼 출력 예시

```
================================
각도 스위치 모듈 테스트
NUCLEO-F103RB
================================

명령어:
  s: 상태 및 통계 출력
  r: 통계 리셋
  a: 경보 모드 토글

모듈을 기울여보세요!

[상태] 움직임 감지
[감지] 기울어짐! (총 1회)
[감지] 원위치 (기울어진 시간: 523ms)
[상태] 안정됨

========== 상태 정보 ==========
현재 상태: 정위치
안정 상태: 안정

========== 통계 정보 ==========
총 기울임 횟수: 5
총 기울어진 시간: 3.25초
평균 기울임 시간: 0.65초
경보 모드: OFF
================================
```

## 📊 센서 동작 원리

```
        정위치                  기울어짐
    ┌───────────┐           ┌───────────┐
    │           │           │        ●  │
    │     ●     │    →      │       ╱   │
    │   ━━━━━   │           │   ━━━●━   │
    │   접점    │           │   접점연결│
    └───────────┘           └───────────┘
      스위치 OFF               스위치 ON
```

### 감지 각도
- 일반적으로 약 15~45도 기울어지면 감지
- 모듈에 따라 감도 차이 있음

## 🔧 파라미터 조정

| 파라미터 | 기본값 | 설명 |
|----------|--------|------|
| `debounceDelay` | 50ms | 디바운싱 시간 |
| `STABILITY_THRESHOLD` | 100 | 안정 판정 기준 (루프 횟수) |

## 📊 볼 스위치와의 비교

| 특성 | 각도 스위치 (KY-020) | 볼 스위치 (KY-017) |
|------|---------------------|-------------------|
| 구조 | 원통형 금속 롤러 | 작은 금속 볼 |
| 감도 | 중간 | 높음 |
| 안정성 | 높음 | 낮음 (민감) |
| 용도 | 기울기 감지 | 진동/움직임 감지 |

## ⚠️ 주의사항

- 기계적 접점이므로 디바운싱 필수
- 정밀한 각도 측정에는 부적합 (디지털 ON/OFF만)
- 진동이 많은 환경에서는 오동작 가능
- 정확한 각도 측정이 필요하면 가속도계 사용 권장

## 📚 응용 분야

- 물건 기울기 감지
- 도난 방지 장치
- 자세 감지
- 기울기 경보 시스템
- 게임 컨트롤러
- 로봇 균형 감지 (보조용)

## 🔄 정밀 각도 측정이 필요한 경우

각도 스위치는 디지털 ON/OFF만 제공합니다. 정밀한 각도 측정이 필요하면:

```
권장 센서:
- MPU6050 (가속도계 + 자이로)
- ADXL345 (가속도계)
- MMA8452 (가속도계)
```

## 🔍 트러블슈팅

| 증상 | 해결 방법 |
|------|----------|
| 감지가 안 됨 | 배선 확인, 기울기 각도 증가 |
| 불안정한 감지 | debounceDelay 증가 |
| 항상 ON 또는 OFF | 모듈 손상 확인, 다른 핀으로 테스트 |
| 너무 민감함 | 진동 격리, 필터링 강화 |

## 📄 라이선스

MIT License
