# STM32F103 Autonomous Robot - System Analysis & Optimization Guide

## ðŸ“‹ í”„ë¡œì íŠ¸ ê°œìš”

ë³¸ í”„ë¡œì íŠ¸ëŠ” STM32F103 ë§ˆì´í¬ë¡œì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ìžìœ¨ì£¼í–‰ ë¡œë´‡ ì‹œìŠ¤í…œìž…ë‹ˆë‹¤. 
ì´ˆìŒíŒŒ ì„¼ì„œì™€ ì„œë³´ ëª¨í„°ë¥¼ ì´ìš©í•œ í™˜ê²½ ìŠ¤ìºë‹, 4ë¥œ DC ëª¨í„° êµ¬ë™, LCD ë””ìŠ¤í”Œë ˆì´ë¥¼ í†µí•œ í‘œì • ì• ë‹ˆë©”ì´ì…˜, ë¸”ë£¨íˆ¬ìŠ¤/UART ê¸°ë°˜ ì›ê²© ì œì–´ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.

---

## ðŸ”§ 1. í•˜ë“œì›¨ì–´ êµ¬ì¡° ë¶„ì„

### 1.1 MCU ì‚¬ì–‘

| í•­ëª© | ì‚¬ì–‘ |
|------|------|
| **MCU** | STM32F103C8T6 (Cortex-M3) |
| **í´ëŸ­** | 64MHz (HSI 8MHz â†’ PLL Ã—16 / 2) |
| **APB1** | 32MHz (HCLK/2) |
| **APB2** | 64MHz (HCLK/1) |
| **Flash** | 64KB |
| **SRAM** | 20KB |

### 1.2 ì£¼ë³€ìž¥ì¹˜ í• ë‹¹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    STM32F103 Pin Assignment                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  GPIOA   â”‚    â”‚  GPIOB   â”‚    â”‚  GPIOC   â”‚    â”‚  GPIOD   â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ PA0:TRIG â”‚    â”‚ PB3:LFF  â”‚    â”‚ PC5:RED  â”‚    â”‚ PD2:LCD  â”‚   â”‚
â”‚  â”‚ PA1:ECHO â”‚    â”‚ PB4:RFF  â”‚    â”‚ PC6:GREENâ”‚    â”‚   RESET  â”‚   â”‚
â”‚  â”‚ PA2:TX   â”‚    â”‚ PB5:RFB  â”‚    â”‚ PC8:BLUE â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”‚ PA3:RX   â”‚    â”‚ PB8:RBF  â”‚    â”‚ PC13:BUZ â”‚                   â”‚
â”‚  â”‚ PA8:LCD  â”‚    â”‚ PB9:RBB  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚  â”‚    DC    â”‚    â”‚ PB10:LBB â”‚                                   â”‚
â”‚  â”‚ PA9:LBF  â”‚    â”‚ PB12:LCD â”‚                                   â”‚
â”‚  â”‚ PA10:LFB â”‚    â”‚    CS    â”‚                                   â”‚
â”‚  â”‚ PA15:    â”‚    â”‚ PB13:SCK â”‚                                   â”‚
â”‚  â”‚  SERVO   â”‚    â”‚ PB15:MOSIâ”‚                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3 íƒ€ì´ë¨¸ í• ë‹¹

| íƒ€ì´ë¨¸ | ê¸°ëŠ¥ | í”„ë¦¬ìŠ¤ì¼€ì¼ëŸ¬ | ì£¼ê¸° | ìš©ë„ |
|--------|------|-------------|------|------|
| **TIM1** | íƒ€ìž„ë² ì´ìŠ¤ | 63 | 65535 | ì´ˆìŒíŒŒ ì„¼ì„œ Î¼s ê³„ì¸¡ (1MHz ì¹´ìš´í„°) |
| **TIM2** | PWM CH1 | 1279 | 999 | ì„œë³´ ëª¨í„° ì œì–´ (50Hz) |
| **TIM3** | PWM CH1 | 1279 | 999 | ì˜ˆë¹„ PWM ì±„ë„ |

### 1.4 í†µì‹  ì¸í„°íŽ˜ì´ìŠ¤

| ì¸í„°íŽ˜ì´ìŠ¤ | ì„¤ì • | ì—°ê²° ìž¥ì¹˜ |
|------------|------|----------|
| **USART2** | 115200-8-N-1 | ë¸”ë£¨íˆ¬ìŠ¤/ë””ë²„ê·¸ ì½˜ì†” |
| **SPI2** | 8MHz, Mode0 | ST7735 LCD (160Ã—80) |
| **I2C1** | 100kHz | I2C LCD (16Ã—2, PCF8574) |

### 1.5 ì„¼ì„œ ë° ì•¡ì¶”ì—ì´í„°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    í•˜ë“œì›¨ì–´ ë¸”ë¡ ë‹¤ì´ì–´ê·¸ëž¨                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ HC-SR04   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ TC118S Ã—4 â”‚  â”‚
â”‚   â”‚ Ultrasonicâ”‚  TRIG    â”‚             â”‚  GPIO    â”‚ DC Motor  â”‚  â”‚
â”‚   â”‚           â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”‚             â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ Driver    â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  ECHO    â”‚             â”‚          â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                          â”‚             â”‚               â”‚         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚   STM32     â”‚          â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ SG90      â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   F103      â”‚          â”‚   4WD     â”‚  â”‚
â”‚   â”‚ Servo     â”‚  PWM     â”‚             â”‚          â”‚  Chassis  â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚             â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                          â”‚             â”‚                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚             â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ ST7735    â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”‚             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ RGB LED   â”‚  â”‚
â”‚   â”‚ 160Ã—80    â”‚  SPI     â”‚             â”‚  GPIO    â”‚ (Common   â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚             â”‚          â”‚  Cathode) â”‚  â”‚
â”‚                          â”‚             â”‚                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚             â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ I2C LCD   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”‚             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Buzzer    â”‚  â”‚
â”‚   â”‚ 16Ã—2      â”‚  I2C     â”‚             â”‚  GPIO    â”‚ (Passive) â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ—ï¸ 2. ì†Œí”„íŠ¸ì›¨ì–´ êµ¬ì¡° ë¶„ì„

### 2.1 ëª¨ë“ˆ ê³„ì¸µ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Application Layer                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚   main.c    â”‚  â”‚ robot_state â”‚  â”‚   ui_fsm    â”‚              â”‚
â”‚  â”‚ (FSM ì œì–´)  â”‚  â”‚ (ìƒíƒœ ê´€ë¦¬) â”‚  â”‚ (UI ìƒíƒœê¸°ê³„)â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         â”‚                â”‚                â”‚                     â”‚
â”‚         â–¼                â–¼                â–¼      Driver Layer   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚    â”‚
â”‚  â”‚  â”‚ultrasonicâ”‚ â”‚  servo  â”‚ â”‚  motor  â”‚ â”‚ buzzer  â”‚       â”‚    â”‚
â”‚  â”‚  â”‚  .c/.h  â”‚ â”‚  .c/.h  â”‚ â”‚  .c/.h  â”‚ â”‚  .c/.h  â”‚        â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜        â”‚    â”‚
â”‚  â”‚       â”‚           â”‚           â”‚           â”‚             â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”        â”‚    â”‚
â”‚  â”‚  â”‚lcd_st735â”‚ â”‚lcd_gfx  â”‚ â”‚  eyes   â”‚ â”‚  anim   â”‚        â”‚    â”‚
â”‚  â”‚  â”‚  .c/.h  â”‚ â”‚  .c/.h  â”‚ â”‚  .c/.h  â”‚ â”‚  .c/.h  â”‚        â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜        â”‚    â”‚
â”‚  â”‚       â”‚           â”‚           â”‚           â”‚             â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”                                            â”‚    â”‚
â”‚  â”‚  â”‚ rgb_led â”‚                                            â”‚    â”‚
â”‚  â”‚  â”‚  .c/.h  â”‚                                            â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                       HAL/CMSIS Layer                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  STM32F1xx_HAL_Driver (GPIO, TIM, SPI, I2C, UART)       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 íŒŒì¼ë³„ ì—­í• 

| íŒŒì¼ | í¬ê¸° | ì—­í•  |
|------|------|------|
| `main.c` | 21KB | ì‹œìŠ¤í…œ ì´ˆê¸°í™”, FSM ì‹¤í–‰, UART ëª…ë ¹ ì²˜ë¦¬ |
| `robot_state.c/h` | 1KB | ì „ì—­ ìƒíƒœ ê´€ë¦¬ (Getter/Setter) |
| `ui_fsm.c/h` | 2.5KB | UI ìƒíƒœ í‘œì‹œ ë° LCD í…ìŠ¤íŠ¸ ì¶œë ¥ |
| `ultrasonic.c/h` | 2KB | HC-SR04 ê±°ë¦¬ ì¸¡ì • (ë¸”ë¡œí‚¹ ë°©ì‹) |
| `servo.c/h` | 1KB | SG90 ì„œë³´ ê°ë„ ì œì–´ (PWM) |
| `motor.c/h` | 3.5KB | 4ë¥œ DC ëª¨í„° ì œì–´ (TC118S Ã—4) |
| `buzzer.c/h` | 3.5KB | ë…¼ë¸”ë¡œí‚¹ ë©œë¡œë”” ìž¬ìƒ |
| `lcd_st7735.c/h` | 4.5KB | ST7735 SPI ë“œë¼ì´ë²„ |
| `lcd_gfx.c/h` | 5KB | ê·¸ëž˜í”½ í”„ë¦¬ë¯¸í‹°ë¸Œ (ì›, ì‚¬ê°í˜•, ì„ ) |
| `eyes.c/h` | 4.5KB | í‘œì • ë Œë”ë§ (Dirty Flag íŒ¨í„´) |
| `anim.c/h` | 2.5KB | ê¹œë¹¡ìž„ ì• ë‹ˆë©”ì´ì…˜ (ë…¼ë¸”ë¡œí‚¹) |
| `rgb_led.c/h` | 1.5KB | RGB LED ìƒíƒœ í‘œì‹œ |
| `robot_config.h` | 2KB | í•˜ë“œì›¨ì–´ í•€ ë§¤í•‘, ìž„ê³„ê°’ ì •ì˜ |

### 2.3 ìƒíƒœ ê¸°ê³„ (FSM) ì„¤ê³„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Robot State Machine (Auto Mode)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚                        â”‚  IDLE    â”‚ â—€â”€â”€â”€ 't' í‚¤ ìž…ë ¥             â”‚
â”‚                        â”‚ (ëŒ€ê¸°)   â”‚                              â”‚
â”‚                        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                             â”‚ start_flag = 1                     â”‚
â”‚                             â–¼                                    â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚            â”‚                                   â”‚                 â”‚
â”‚            â–¼                                   â”‚                 â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      ì„œë³´ 30Â°~150Â°      â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”           â”‚
â”‚      â”‚  SCAN    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚  DECIDE  â”‚           â”‚
â”‚      â”‚ (ìŠ¤ìº”)   â”‚      ìŠ¤ìº” ì™„ë£Œ          â”‚  (ê²°ì •)  â”‚            â”‚
â”‚      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜            â”‚
â”‚           â”‚                                   â”‚                  â”‚
â”‚           â”‚ â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚
â”‚           â”‚              dist > 40cm          â”‚                  â”‚
â”‚           â”‚                                   â”‚ dist <= 40cm     â”‚
â”‚           â–¼                                   â–¼                  â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚      â”‚  MOVE    â”‚                       â”‚  ALERT   â”‚           â”‚
â”‚      â”‚ (ì „ì§„)   â”‚                       â”‚ (íšŒí”¼)   â”‚           â”‚
â”‚      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜           â”‚
â”‚           â”‚                                   â”‚                 â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                        120ms íšŒí”¼ í›„                            â”‚
â”‚                                                                  â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚   â”‚                  Manual Mode ('w/a/s/d')                â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚   W: FORWARD    A: LEFT    S: BACKWARD    D: RIGHT      â”‚   â”‚
â”‚   â”‚   X: STOP       R: SERVO RESET                          â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.4 í‘œì • ì‹œìŠ¤í…œ

```c
typedef enum {
    EXPR_NEUTRAL,    // ê¸°ë³¸ í‘œì • (ë‘¥ê·¼ ëˆˆ)
    EXPR_BLINK,      // ê¹œë¹¡ìž„ (ê°€ë¡œì„ )
    EXPR_HAPPY,      // ì›ƒëŠ” í‘œì • (ë°˜ì›)
    EXPR_ANGRY,      // í™”ë‚œ í‘œì • (ëŒ€ê°ì„ )
    EXPR_SLEEPY,     // ì¡¸ë¦° í‘œì • (ê°ì€ ëˆˆ)
    EXPR_SAD,        // ìŠ¬í”ˆ í‘œì • (ì²˜ì§„ ëˆˆ)
    EXPR_LOOK_LEFT,  // ì™¼ìª½ ì‘ì‹œ
    EXPR_LOOK_RIGHT  // ì˜¤ë¥¸ìª½ ì‘ì‹œ
} Expression_t;
```

**ê¹œë¹¡ìž„ íƒ€ì´ë°:**
- ì£¼ê¸°: 3000ms
- ëˆˆ ê°ëŠ” ì‹œê°„: 150ms
- ë…¼ë¸”ë¡œí‚¹ íƒ€ì´ë¨¸ ê¸°ë°˜

---

## â±ï¸ 3. íƒ€ì´ë° ë¶„ì„

### 3.1 ë©”ì¸ ë£¨í”„ ì‹œê°„ ì˜ˆì‚°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Main Loop Timing Budget                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Target Loop Time: 10~15ms (ìµœì†Œ 66Hz)                          â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                  Time Breakdown                          â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  Ultrasonic_GetDistance()     â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚ ~30ms   â”‚    â”‚
â”‚  â”‚  (ë¸”ë¡œí‚¹, ìµœëŒ€ ê±°ë¦¬ ì‹œ)        â”‚               â”‚ âš ï¸ ë³‘ëª©  â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  LCD Eyes Rendering           â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚      ~15ms    â”‚    â”‚
â”‚  â”‚  (ì „ì²´ ìž¬ê·¸ë¦¬ê¸° ì‹œ)            â”‚         â”‚               â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  UI_Update() + LCD Text       â”‚â–ˆâ–ˆâ–ˆâ–ˆâ”‚           ~5ms     â”‚    â”‚
â”‚  â”‚  (I2C LCD 16Ã—2)               â”‚    â”‚                    â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  Buzzer_Update()              â”‚â”‚              <100Î¼s    â”‚    â”‚
â”‚  â”‚  (ìƒíƒœ ì²´í¬ë§Œ)                 â”‚â”‚                        â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  FSM Logic                    â”‚â”‚              <100Î¼s    â”‚    â”‚
â”‚  â”‚  (GPIO, ìƒíƒœ ì „ì´)             â”‚â”‚                        â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  UART printf (ë””ë²„ê·¸)         â”‚â–ˆâ–ˆâ”‚             ~2ms     â”‚    â”‚
â”‚  â”‚  (115200bps, ~20ìž)           â”‚  â”‚                      â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â”‚  âš ï¸  ì´ ì˜ˆìƒ ìµœì•… ì¼€ì´ìŠ¤: ~52ms (19Hz)                          â”‚
â”‚  âœ…  ìµœì í™” í›„ ëª©í‘œ: ~10ms (100Hz)                              â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 ì£¼ìš” ë³‘ëª© ì§€ì 

| ë³‘ëª© ì§€ì  | í˜„ìž¬ ì‹œê°„ | ì›ì¸ | ì˜í–¥ |
|-----------|----------|------|------|
| **Ultrasonic** | ~30ms | ë¸”ë¡œí‚¹ ì—ì½” ëŒ€ê¸° | ì „ì²´ ë£¨í”„ ì§€ì—° |
| **LCD ë Œë”ë§** | ~15ms | ì „ì²´ í™”ë©´ í´ë¦¬ì–´ í›„ ìž¬ê·¸ë¦¬ê¸° | ê¹œë¹¡ìž„, ë°˜ì‘ ì§€ì—° |
| **I2C LCD** | ~5ms | 100kHz I2C + 4ë¹„íŠ¸ ëª¨ë“œ | UI ì—…ë°ì´íŠ¸ ì§€ì—° |
| **UART printf** | ~2ms | ë¸”ë¡œí‚¹ ì „ì†¡ | ë””ë²„ê·¸ ì‹œ ì„±ëŠ¥ ì €í•˜ |

### 3.3 ì¸í„°ëŸ½íŠ¸ ì‘ë‹µ ì‹œê°„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Interrupt Latency Analysis                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  UART RX Interrupt (HAL_UART_RxCpltCallback)                    â”‚
â”‚  â”œâ”€ ìš°ì„ ìˆœìœ„: ê¸°ë³¸ (ë¯¸ì„¤ì •)                                      â”‚
â”‚  â”œâ”€ ì²˜ë¦¬ ì‹œê°„: ~5Î¼s (ëª…ë ¹ íŒŒì‹±)                                 â”‚
â”‚  â””â”€ ë¬¸ì œ: Handle_Command() ë‚´ Motor/Buzzer í˜¸ì¶œë¡œ ì§€ì—° ê°€ëŠ¥     â”‚
â”‚                                                                  â”‚
â”‚  SysTick (1ms)                                                  â”‚
â”‚  â”œâ”€ HAL_GetTick() ì—…ë°ì´íŠ¸                                      â”‚
â”‚  â””â”€ ë¬¸ì œ ì—†ìŒ                                                    â”‚
â”‚                                                                  â”‚
â”‚  âš ï¸ ë¯¸ì‚¬ìš© ì¸í„°ëŸ½íŠ¸:                                            â”‚
â”‚  â”œâ”€ TIM1 (Input Capture ê°€ëŠ¥)                                   â”‚
â”‚  â””â”€ DMA (SPI/UART ê°€ëŠ¥)                                         â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸš€ 4. ìµœì í™” ë°©ì•ˆ

### 4.1 ì´ˆìŒíŒŒ ì„¼ì„œ ìµœì í™” (High Priority)

**í˜„ìž¬ ë¬¸ì œ:** ë¸”ë¡œí‚¹ ë°©ì‹ìœ¼ë¡œ ì—ì½” ëŒ€ê¸° (ìµœëŒ€ 30ms)

**ìµœì í™” ë°©ì•ˆ:**

| ë°©ì•ˆ | ë³µìž¡ë„ | ê°œì„  íš¨ê³¼ | ì„¤ëª… |
|------|--------|----------|------|
| **A. íƒ€ì´ë¨¸ Input Capture** | ì¤‘ | 30ms â†’ 0ms | TIM1 CH1ì„ Input Captureë¡œ ì„¤ì •, ì—ì½” ì‹œìž‘/ë ìº¡ì²˜ |
| **B. ì™¸ë¶€ ì¸í„°ëŸ½íŠ¸** | í•˜ | 30ms â†’ 0ms | EXTIë¡œ ECHO í•€ ì–‘ìª½ ì—ì§€ ì¸í„°ëŸ½íŠ¸ |
| **C. ë…¼ë¸”ë¡œí‚¹ í´ë§** | í•˜ | ë¶€ë¶„ ê°œì„  | íƒ€ìž„ì•„ì›ƒ ë¶„í• , ë‹¤ë¥¸ ìž‘ì—… ì¸í„°ë¦¬ë¹™ |

**ê¶Œìž¥: ë°©ì•ˆ A (Input Capture)**

```
[Trigger] â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€ [ECHO Rising] â”€â”€â”€ [ECHO Falling]
              â”‚     â”‚           â”‚                 â”‚
              â–¼     â–¼           â–¼                 â–¼
         TRIG=HIGH(10Î¼s)   TIM1 CCR1=0      TIM1 CCR1=echo_us
              â”‚                 â”‚                 â”‚
              â”‚                 â”‚                 â”‚
         CPU FREE â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
         (ë‹¤ë¥¸ ìž‘ì—… ìˆ˜í–‰)                          â”‚
                                                  â–¼
                                            ê±°ë¦¬ = echo_us Ã— 0.017
```

### 4.2 LCD ë Œë”ë§ ìµœì í™” (High Priority)

**í˜„ìž¬ ë¬¸ì œ:** 
- ë§¤ í”„ë ˆìž„ ì „ì²´ ì˜ì—­ í´ë¦¬ì–´ í›„ ìž¬ê·¸ë¦¬ê¸°
- ë¶ˆí•„ìš”í•œ SPI ì „ì†¡ëŸ‰

**ìµœì í™” ë°©ì•ˆ:**

| ë°©ì•ˆ | ë³µìž¡ë„ | ê°œì„  íš¨ê³¼ | ì„¤ëª… |
|------|--------|----------|------|
| **A. Dirty Rectangle** | ì¤‘ | 50~70% ê°ì†Œ | ë³€ê²½ëœ ì˜ì—­ë§Œ ì—…ë°ì´íŠ¸ |
| **B. ë”ë¸” ë²„í¼ë§** | ìƒ | ê¹œë¹¡ìž„ ì œê±° | SRAM ë¶€ì¡±ìœ¼ë¡œ ë¶€ë¶„ ì ìš© |
| **C. DMA SPI** | ì¤‘ | 30~50% ê°ì†Œ | SPI ì „ì†¡ ì¤‘ CPU í•´ë°© |
| **D. SPI ì†ë„ ì¦ê°€** | í•˜ | 2ë°° í–¥ìƒ | 8MHz â†’ 16MHz (ê°€ëŠ¥ ì‹œ) |

**ê¶Œìž¥: ë°©ì•ˆ A + C**

```
í˜„ìž¬:
[Clear ì „ì²´] â”€â”€â–¶ [Draw Eye L] â”€â”€â–¶ [Draw Eye R] â”€â”€â–¶ ì™„ë£Œ
     5ms              5ms              5ms         = 15ms

ìµœì í™” í›„ (Dirty Rect + DMA):
[Draw Changed Area Only] â”€â”€â–¶ ì™„ë£Œ
        3~5ms
```

### 4.3 UART ë””ë²„ê·¸ ìµœì í™” (Medium Priority)

**í˜„ìž¬ ë¬¸ì œ:** ë¸”ë¡œí‚¹ HAL_UART_Transmit()ìœ¼ë¡œ printf ì§€ì—°

**ìµœì í™” ë°©ì•ˆ:**

| ë°©ì•ˆ | ë³µìž¡ë„ | ê°œì„  íš¨ê³¼ | ì„¤ëª… |
|------|--------|----------|------|
| **A. DMA ì „ì†¡** | ì¤‘ | 2ms â†’ 0ms | ë§ ë²„í¼ + DMA |
| **B. IT ì „ì†¡** | í•˜ | 2ms â†’ 0ms | ì¸í„°ëŸ½íŠ¸ ê¸°ë°˜ ì „ì†¡ |
| **C. ì¡°ê±´ë¶€ ì»´íŒŒì¼** | í•˜ | ì™„ì „ ì œê±° | #ifdef DEBUG |
| **D. ë¡œê·¸ ë ˆë²¨** | í•˜ | 50% ê°ì†Œ | ì¤‘ìš” ë©”ì‹œì§€ë§Œ ì¶œë ¥ |

**ê¶Œìž¥: ë°©ì•ˆ A + D**

### 4.4 FSM êµ¬ì¡° ê°œì„  (Medium Priority)

**í˜„ìž¬ ë¬¸ì œ:**
- switch-case ì¤‘ì²©ìœ¼ë¡œ ê°€ë…ì„± ì €í•˜
- ìƒíƒœë³„ ì½”ë“œê°€ main.cì— ì§‘ì¤‘

**ê°œì„  ë°©ì•ˆ:**

```
í˜„ìž¬ êµ¬ì¡°:
main.c (700+ lines)
â”œâ”€â”€ ì´ˆê¸°í™” ì½”ë“œ
â”œâ”€â”€ FSM ë¡œì§
â”œâ”€â”€ I2C LCD í•¨ìˆ˜ë“¤
â”œâ”€â”€ UART í•¸ë“¤ëŸ¬
â””â”€â”€ ê¸°íƒ€ ìœ í‹¸ë¦¬í‹°

ê¶Œìž¥ êµ¬ì¡°:
main.c (~200 lines)
â”œâ”€â”€ ì´ˆê¸°í™” í˜¸ì¶œ
â””â”€â”€ ìŠˆí¼ë£¨í”„

fsm_auto.c/h
â”œâ”€â”€ Auto ëª¨ë“œ FSM
â”œâ”€â”€ ìƒíƒœ í•¸ë“¤ëŸ¬ í•¨ìˆ˜ í¬ì¸í„° í…Œì´ë¸”
â””â”€â”€ ìƒíƒœ ì „ì´ ë¡œì§

fsm_manual.c/h
â”œâ”€â”€ Manual ëª¨ë“œ FSM
â””â”€â”€ ëª…ë ¹ ì²˜ë¦¬

i2c_lcd.c/h
â”œâ”€â”€ I2C LCD ë“œë¼ì´ë²„ ë¶„ë¦¬
â””â”€â”€ main.cì—ì„œ ì œê±°
```

### 4.5 ì „ë ¥ ì†Œë¹„ ìµœì í™” (Low Priority)

**í˜„ìž¬ ë¬¸ì œ:** ì§€ì†ì  í´ë§ìœ¼ë¡œ CPU 100% ì‚¬ìš©

**ìµœì í™” ë°©ì•ˆ:**

| ë°©ì•ˆ | ë³µìž¡ë„ | ê°œì„  íš¨ê³¼ | ì„¤ëª… |
|------|--------|----------|------|
| **A. Sleep Mode** | ì¤‘ | 30~50% ì ˆê° | WFI ëª…ë ¹ì–´ ì‚¬ìš© |
| **B. ì ì‘ì  ì—…ë°ì´íŠ¸** | í•˜ | 20% ì ˆê° | IDLE ì‹œ UI ì—…ë°ì´íŠ¸ ì£¼ê¸° ì—°ìž¥ |
| **C. LCD ë°±ë¼ì´íŠ¸ PWM** | í•˜ | 15% ì ˆê° | ë°ê¸° ì¡°ì ˆ |

---

## ðŸ“Š 5. ìµœì í™” ìš°ì„ ìˆœìœ„ ë° ë¡œë“œë§µ

### 5.1 Phase 1: í•µì‹¬ ë³‘ëª© í•´ê²° (1~2ì£¼)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [P1] ì´ˆìŒíŒŒ ì„¼ì„œ Input Capture ì ìš©                            â”‚
â”‚       ì˜ˆìƒ íš¨ê³¼: ë£¨í”„ ì‹œê°„ 30ms ë‹¨ì¶•                            â”‚
â”‚       í•„ìš” ë¦¬ì†ŒìŠ¤: TIM1 CH1 ìž¬ì„¤ì •                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [P1] LCD DMA SPI ì „ì†¡                                          â”‚
â”‚       ì˜ˆìƒ íš¨ê³¼: ë Œë”ë§ ì‹œê°„ 50% ë‹¨ì¶•                           â”‚
â”‚       í•„ìš” ë¦¬ì†ŒìŠ¤: DMA1 CH5 (SPI2_TX)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 Phase 2: êµ¬ì¡° ê°œì„  (2~3ì£¼)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [P2] Eyes ë Œë”ë§ Dirty Rectangle ì ìš©                          â”‚
â”‚       ì˜ˆìƒ íš¨ê³¼: ë¶ˆí•„ìš”í•œ í´ë¦¬ì–´ ì œê±°, ê¹œë¹¡ìž„ ê°ì†Œ              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [P2] UART DMA + ë§ ë²„í¼ ì ìš©                                   â”‚
â”‚       ì˜ˆìƒ íš¨ê³¼: ë””ë²„ê·¸ ì¶œë ¥ ë…¼ë¸”ë¡œí‚¹í™”                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [P2] FSM ëª¨ë“ˆ ë¶„ë¦¬                                             â”‚
â”‚       ì˜ˆìƒ íš¨ê³¼: ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ, main.c 500ì¤„ ê°ì†Œ            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 Phase 3: ê³ ê¸‰ ìµœì í™” (ì„ íƒ)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [P3] ìƒíƒœë³„ í‘œì • ì—°ë™ ê°•í™”                                      â”‚
â”‚       SCAN â†’ LOOK_LEFT/RIGHT, ALERT â†’ ANGRY                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [P3] ì „ë ¥ ìµœì í™” (Sleep ëª¨ë“œ)                                  â”‚
â”‚       ë°°í„°ë¦¬ êµ¬ë™ ì‹œ í•„ìš”                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [P3] OTA íŽŒì›¨ì–´ ì—…ë°ì´íŠ¸ (ì„ íƒ)                                â”‚
â”‚       Bootloader êµ¬í˜„ í•„ìš”                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ“ˆ 6. ì˜ˆìƒ ì„±ëŠ¥ ê°œì„ 

| ì§€í‘œ | í˜„ìž¬ | Phase 1 í›„ | Phase 2 í›„ |
|------|------|-----------|-----------|
| **ë©”ì¸ ë£¨í”„ ì£¼ê¸°** | ~52ms (19Hz) | ~22ms (45Hz) | ~10ms (100Hz) |
| **UI ì‘ë‹µì„±** | 200ms | 100ms | 50ms |
| **CPU ì‚¬ìš©ë¥ ** | ~95% | ~60% | ~40% |
| **ì½”ë“œ ìœ ì§€ë³´ìˆ˜ì„±** | â˜…â˜…â˜†â˜†â˜† | â˜…â˜…â˜…â˜†â˜† | â˜…â˜…â˜…â˜…â˜† |

---

## ðŸ”— 7. ì°¸ê³  ìžë£Œ

### 7.1 ê´€ë ¨ ë¬¸ì„œ
- STM32F103 Reference Manual (RM0008)
- STM32F1 HAL Driver User Manual (UM1850)
- ST7735 Datasheet
- HC-SR04 Application Note

### 7.2 ê¶Œìž¥ ë¼ì´ë¸ŒëŸ¬ë¦¬
- STM32 LL Driver (HAL ëŒ€ë¹„ ì €ìˆ˜ì¤€ ì œì–´)
- FreeRTOS (ë©€í‹°íƒœìŠ¤í‚¹ í•„ìš” ì‹œ)
- SEGGER SystemView (ì‹¤ì‹œê°„ íƒ€ì´ë° ë¶„ì„)

---

## ðŸ“ 8. ë²„ì „ ížˆìŠ¤í† ë¦¬

| ë²„ì „ | ë‚ ì§œ | ë³€ê²½ ë‚´ìš© |
|------|------|----------|
| 1.0.0 | 2026-01 | ì´ˆê¸° êµ¬ì¡° ë¶„ì„ ë° ìµœì í™” ë°©ì•ˆ ìž‘ì„± |

---

*ë³¸ ë¬¸ì„œëŠ” ì½”ë“œ ë¶„ì„ì„ ê¸°ë°˜ìœ¼ë¡œ ìž‘ì„±ë˜ì—ˆìœ¼ë©°, ì‹¤ì œ í•˜ë“œì›¨ì–´ í…ŒìŠ¤íŠ¸ë¥¼ í†µí•œ ê²€ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.*
